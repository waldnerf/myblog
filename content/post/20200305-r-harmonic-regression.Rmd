---
title: "Harmonic regression in R"
author: "Franz Waldner"
date: 2020-03-10T21:13:14-05:00
categories: ["R"]
tags: ["ggplot2"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

# Time series analysis with Harmonic regression.



```{r include=T, eval=F}
harmonic_regression <- function(x, y, omega = 1.5){
  notna <- !is.na(y)
  if(sum(notna)>7){
    hr <- lm(y~cos(t1)+sin(t1)+cos(t2)+sin(t2),
             data = data.frame(t1=(2*omega*pi*x[notna]),
                               t2=(4*omega*pi*x[notna]),
                               y = y[notna]))
    out <- c(hr$coefficients, r2=summary(hr)$r.squared, rmse=sqrt(mean(hr$residuals^2)))
  } else {
    out <- rep(NA, 7)
    names(out) <- c("(Intercept)", "cos(t1)", "sin(t1)", "cos(t2)", "sin(t2)", "r2", "rmse")
  }
  return(out)
}

library(ggplot2)



```
